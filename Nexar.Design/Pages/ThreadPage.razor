@page "/thread"
@inherits AbstractPage

@if (ThreadItem.Current is not null)
{
    <ItemPageHeader Text="Thread" Item=@ThreadItem.Current />

    <TextFieldCopy Label="CommentThreadId" Text=@ThreadItem.Current.Tag.CommentThreadId />

    @if (ThreadItem.Current.Tag.OriginalStateScreenshotUrl is not null)
    {
        <FieldImage Label="Original screenshot" Src=@ThreadItem.Current.Tag.OriginalStateScreenshotUrl />
    }

    @foreach (var comment in ThreadItem.Current.Tag.Comments)
    {
        <CardComment Text=@comment.Text>
            <Head>
                <TextKeyValue Key="CommentId" Value=@comment.CommentId />
                <TextKeyValue Key="CreatedBy" Value=@(comment.CreatedBy.UserId + " / " + comment.CreatedBy.Email) />
            </Head>
        </CardComment>
    }
}

@code {
    protected override void OnInitialized()
    {
        ThreadItem.OnChange += StateHasChanged;
    }

    protected override void Disposing()
    {
        ThreadItem.OnChange -= StateHasChanged;
    }
}
