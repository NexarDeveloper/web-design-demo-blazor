@page "/VariantBom"
@inherits AbstractPage
@using Data = VariantBomItem

<ItemPageHeader Text="BOM" Item=@Data.Current />

@if (Data.Current?.Tag is not null)
{
    <TextFieldCopy Label="Id" Text=@Data.Current.Tag.Id />

    <br />
    <MudTable Items=@Data.Current.Tag.BomItems Dense=true>
        <HeaderContent>
            <MudTh>Component.Name</MudTh>
            <MudTh>Component.IsManaged</MudTh>
            <MudTh>Quantity</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Name">@context.Component.Name</MudTd>
            <MudTd DataLabel="IsManaged">@context.Component.IsManaged</MudTd>
            <MudTd DataLabel="Quantity">@context.Quantity</MudTd>
        </RowTemplate>
        <PagerContent>
            <MudTablePager />
        </PagerContent>
    </MudTable>

    <br />
    <AlertGraphQL Files="Project.Variants.graphql Variant.Bom.graphql" />
}
else
{
    <MudProgressLinear Indeterminate=true />
}

@code {
    protected override void OnInitialized()
    {
        Data.OnChange += StateHasChanged;
    }

    protected override void Disposing()
    {
        Data.OnChange -= StateHasChanged;
    }
}
